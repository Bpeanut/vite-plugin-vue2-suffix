import e from"fs";import c from"path";const t=(e,t)=>e.includes("@")?process.cwd()+"/src":c.parse(t).dir;function n(e,n){return e&&e.map((e=>{if(e.includes("@")){let s=e.replace("@/","");return c.join(t(e,n),s)}return c.resolve(t(e,n),e)}))}function s(){return{name:"vite-plugin-vue2-suffix",apply:"serve",transform(c,t){const s=(t,n)=>{if(!t.includes(".svg")&&!t.includes(".vue")&&n.includes("/"))try{e.accessSync(`${t}.vue`,e.constants.R_OK),c=c.replace(`'${n}'`,`'${n}.vue'`)}catch(e){c=c.replace(`'${n}'`,`'${n}/index.vue'`)}};return(()=>{if(t.includes(".vue")&&!t.includes("?")){const e=function(e){let c=e.match(/(?<=components:(\s)*)({(?:[^}]+)})/g);const t=c&&c[0].replace(/\/\/(.*)/g,"");return c=t&&t.split(","),c&&c.map((e=>e.replace(/\n*/g,"").replace(/\s*/g,"").replace(/{/,"").replace(/}/,"")))}(c);if(e){const{pathList:r=[],componentShortPath:o=[]}=function(e,c,t){if(!e)return{};const s=e.join("|"),r=new RegExp(`(?<=(import\\s(${s})\\sfrom\\s))(\\'(.*)\\')`,"g");let o=c.match(r)&&c.match(r).map((e=>e.replace(/\'/g,"")));return{pathList:n(o,t),componentShortPath:o}}(e,c,t);e.length&&r&&r.forEach(((e,c)=>{s(e,o[c])}))}}})(),t.includes("/router")&&((()=>{const s=c.match(/(?<=(component: \(\)\s\=\>\simport\(\')).*(?=(\'\)))/g);if(s){const r=n(s,t);r&&r.forEach(((t,n)=>{const r=s[n];if(!r.includes(".vue"))try{e.accessSync(`${t}.vue`,e.constants.R_OK),c=c.replace(`'${r}'`,`'${r}.vue'`)}catch(e){c=c.replace(`'${r}'`,`'${r}/index.vue'`)}}))}})(),(()=>{const e=c.match(/(?<=(import\s\w*\sfrom\s\'))(.*)(?=(\'))/g);let r=[];e&&e.forEach((e=>{e.includes(".vue")||(e.includes("/views")||e.includes("/components"))&&r.push(`${e}`)}));const o=r&&n(r,t);r&&r.length&&o&&o.forEach(((e,c)=>{s(e,r[c])}))})()),c}}}export{s as default};
