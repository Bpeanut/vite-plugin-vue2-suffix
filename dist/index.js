"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("fs"),t=require("path");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=c(e),s=c(t);const r=(e,t)=>e.includes("@")?process.cwd()+"/src":s.default.parse(t).dir;function u(e,t){return e&&e.map((e=>{if(e.includes("@")){let c=e.replace("@/","");return s.default.join(r(e,t),c)}return s.default.resolve(r(e,t),e)}))}exports.default=function(){return{name:"vite-plugin-vue2-suffix",apply:"serve",transform(e,t){const c=(t,c)=>{if(!t.includes(".svg")&&!t.includes(".vue")&&c.includes("/"))try{n.default.accessSync(`${t}.vue`,n.default.constants.R_OK),e=e.replace(`'${c}'`,`'${c}.vue'`)}catch(t){e=e.replace(`'${c}'`,`'${c}/index.vue'`)}};return(()=>{if(t.includes(".vue")&&!t.includes("?")){const n=function(e){let t=e.match(/(?<=components:(\s)*)({(?:[^}]+)})/g);const c=t&&t[0].replace(/\/\/(.*)/g,"");return t=c&&c.split(","),t&&t.map((e=>e.replace(/\n*/g,"").replace(/\s*/g,"").replace(/{/,"").replace(/}/,"")))}(e);if(n){const{pathList:s=[],componentShortPath:r=[]}=function(e,t,c){if(!e)return{};const n=e.join("|"),s=new RegExp(`(?<=(import\\s(${n})\\sfrom\\s))(\\'(.*)\\')`,"g");let r=t.match(s)&&t.match(s).map((e=>e.replace(/\'/g,"")));return{pathList:u(r,c),componentShortPath:r}}(n,e,t);n.length&&s&&s.forEach(((e,t)=>{c(e,r[t])}))}}})(),t.includes("/router")&&((()=>{const c=e.match(/(?<=(component: \(\)\s\=\>\simport\(\')).*(?=(\'\)))/g);if(c){const s=u(c,t);s&&s.forEach(((t,s)=>{const r=c[s];if(!r.includes(".vue"))try{n.default.accessSync(`${t}.vue`,n.default.constants.R_OK),e=e.replace(`'${r}'`,`'${r}.vue'`)}catch(t){e=e.replace(`'${r}'`,`'${r}/index.vue'`)}}))}})(),(()=>{const n=e.match(/(?<=(import\s\w*\sfrom\s\'))(.*)(?=(\'))/g);let s=[];n&&n.forEach((e=>{e.includes(".vue")||(e.includes("/views")||e.includes("/components"))&&s.push(`${e}`)}));const r=s&&u(s,t);s&&s.length&&r&&r.forEach(((e,t)=>{c(e,s[t])}))})()),e}}},module.exports=Object.assign(exports.default,exports);
